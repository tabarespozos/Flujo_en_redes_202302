%% Datos del Sistema de 84 barras

% Datos globales
nref  = 84;         % nodo de referencia
vref  = 1.0;        % voltaje en la subestación (pu)
vbase = 11.40;      % Voltaje base (kV)
sbase = 10000;      % Potencia base (kVA)
tol   = 10^-8;      % Tolerancia de error permitida
vmin  = 0.93;       % Voltaje mínimo (pu)
vmax  = 1.05;       % Voltaje máximo (pu)

% Base de impedancia
zbase = 1000*((vbase^2)/sbase);

% Datos de ramas
%         desde  hacia       R(ohm)   X(ohm)
ramos = [  1      84       0.1944   0.6624
           1       2       0.2096   0.4304
           2       3       0.2358   0.4842
           3       4       0.0917   0.1883
           4       5       0.2096   0.4304
           5       6       0.0393   0.0807
           6       7       0.0405   0.1380
           7       8       0.1048   0.2152
           7       9       0.2358   0.4842
           7      10       0.1048   0.2152
          11      84       0.0786   0.1614
          11      12       0.3406   0.6944
          12      13       0.0262   0.0538
          12      14       0.0786   0.1614
          15      84       0.1134   0.3864
          15      16       0.0524   0.1076
          16      17       0.0524   0.1076
          17      18       0.1572   0.3228
          18      19       0.0393   0.0807
          19      20       0.1703   0.3497
          20      21       0.2358   0.4842
          21      22       0.1572   0.3228
          21      23       0.1965   0.4035
          23      24       0.1310   0.2690
          25      84       0.0567   0.1932
          25      26       0.1048   0.2152
          26      27       0.2489   0.5111
          27      28       0.0486   0.1656
          28      29       0.1310   0.2690
          30      84       0.1965   0.3960
          30      31       0.1310   0.2690
          31      32       0.1310   0.2690
          32      33       0.0262   0.0538
          33      34       0.1703   0.3497
          34      35       0.0524   0.1076
          35      36       0.4978   1.0222
          36      37       0.0393   0.0807
          37      38       0.0393   0.0807
          38      39       0.0786   0.1614
          39      40       0.2096   0.4304
          38      41       0.1965   0.4035
          41      42       0.2096   0.4304
          43      84       0.0486   0.1656
          43      44       0.0393   0.0807
          44      45       0.1310   0.2690
          45      46       0.2358   0.4842
          47      84       0.2430   0.8280
          47      48       0.0655   0.1345
          48      49       0.0655   0.1345
          49      50       0.0393   0.0807
          50      51       0.0786   0.1614
          51      52       0.0393   0.0807
          52      53       0.0786   0.1614
          53      54       0.0524   0.1076
          54      55       0.1310   0.2690
          56      84       0.2268   0.7728
          56      57       0.5371   1.1029
          57      58       0.0524   0.1076
          58      59       0.0405   0.1380
          59      60       0.0393   0.0807
          60      61       0.0262   0.0538
          61      62       0.1048   0.2152
          62      63       0.2358   0.4842
          63      64       0.0243   0.0828
          65      84       0.0486   0.1656
          65      66       0.1703   0.3497
          66      67       0.1215   0.4140
          67      68       0.2187   0.7452
          68      69       0.0486   0.1656
          69      70       0.0729   0.2484
          70      71       0.0567   0.1932
          71      72       0.0262   0.0528
          73      84       0.3240   1.1040
          73      74       0.0324   0.1104
          74      75       0.0567   0.1932
          75      76       0.0486   0.1656
          77      84       0.2511   0.8556
          77      78       0.1296   0.4416
          78      79       0.0486   0.1656
          79      80       0.1310   0.2640
          80      81       0.1310   0.2640
          81      82       0.0917   0.1883
          82      83       0.3144   0.6456
           5      55       0.1310   0.2690
           7      60       0.1310   0.2690
          11      43       0.1310   0.2690
          12      72       0.3406   0.6994
          13      76       0.4585   0.9415
          14      18       0.5371   1.0824
          16      26       0.0917   0.1883
          20      83       0.0786   0.1614
          28      32       0.0524   0.1076
          29      39       0.0786   0.1614
          34      46       0.0262   0.0538
          40      42       0.1965   0.4035
          53      64       0.0393   0.0807 ];

% Demanda de potencia activa y reactiva en las barras
%             barra          Pd(kW)   Qd(kW) Qbc(kW)
barras = [        1             0.0      0.0     0.0   
                  2           100.0     50.0     0.0
                  3           300.0    200.0     0.0  
                  4           350.0    250.0     0.0  
                  5           220.0    100.0     0.0  
                  6          1100.0    800.0     0.0  
                  7           400.0    320.0     0.0  
                  8           300.0    200.0     0.0  
                  9           300.0    230.0     0.0  
                  10          300.0    260.0     0.0  
                  11            0.9      0.0     0.0  
                  12         1200.0    800.0     0.0   
                  13          800.0    600.0     0.0
                  14          700.0    500.0     0.0  
                  15            0.0      0.0     0.0  
                  16          300.0    150.0     0.0  
                  17          500.0    350.0     0.0  
                  18          700.0    400.0     0.0  
                  19         1200.0   1000.0     0.0  
                  20          300.0    300.0     0.0  
                  21          400.0    350.0     0.0  
                  22           50.0     20.0     0.0  
                  23           50.0     20.0     0.0  
                  24           50.0     10.0     0.0  
                  25           50.0     30.0     0.0   
                  26          100.0     60.0     0.0
                  27          100.0     70.0     0.0  
                  28         1800.0   1300.0     0.0  
                  29          200.0    120.0     0.0  
                  30            0.0      0.0     0.0  
                  31         1800.0   1600.0     0.0   
                  32          200.0    150.0     0.0
                  33          200.0    100.0     0.0   
                  34          800.0    600.0     0.0
                  35          100.0     60.0     0.0  
                  36          100.0     60.0     0.0
                  37           20.0     10.0     0.0  
                  38           20.0     10.0     0.0
                  39           20.0     10.0     0.0   
                  40           20.0     10.0     0.0  
                  41          200.0    160.0     0.0  
                  42           50.0     30.0     0.0  
                  43            0.0      0.0     0.0  
                  44           30.0     20.0     0.0   
                  45          800.0    700.0     0.0
                  46          200.0    150.0     0.0   
                  47            0.0      0.0     0.0
                  48            0.0      0.0     0.0   
                  49            0.0      0.0     0.0   
                  50          200.0    160.0     0.0    
                  51          800.0    600.0     0.0  
                  52          500.0    300.0     0.0      
                  53          500.0    350.0     0.0  
                  54          500.0    300.0     0.0  
                  55          200.0     80.0     0.0  
                  56            0.0      0.0     0.0  
                  57           30.0     20.0     0.0  
                  58          600.0    420.0     0.0  
                  59            0.0      0.0     0.0  
                  60           20.0     10.0     0.0   
                  61           20.0     10.0     0.0
                  62          200.0    130.0     0.0  
                  63          300.0    240.0     0.0      
                  64          300.0    200.0     0.0   
                  65            0.0      0.0     0.0    
                  66           50.0     30.0     0.0  
                  67            0.0      0.0     0.0      
                  68          400.0    360.0     0.0  
                  69            0.0      0.0     0.0  
                  70            0.0      0.0     0.0
                  71         2000.0   1500.0     0.0  
                  72          200.0    150.0     0.0  
                  73            0.0      0.0     0.0   
                  74            0.0      0.0     0.0
                  75         1200.0    950.0     0.0  
                  76          300.0    180.0     0.0      
                  77            0.0      0.0     0.0   
                  78          400.0    360.0     0.0    
                  79         2000.0   1300.0     0.0  
                  80          200.0    140.0     0.0      
                  81          500.0    360.0     0.0  
                  82          100.0     30.0     0.0  
                  83          400.0    360.0     0.0
                  84            0.0      0.0     0.0 ];